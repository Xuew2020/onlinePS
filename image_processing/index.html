<!DOCTYPE html>
<html>
<head>
	<title>图像处理测试页面</title>
	<meta charset="utf-8">
	<style type="text/css">
		#panel{
			height: 500px;
			width: 800px;
			margin: 0 auto;
			box-shadow: 0 0 5px gray;
			overflow: hidden;

		}
		anvas{
			box-shadow: 0 0 3px gray;
		}
	</style>
</head>
<body>
	<main>
		<div id="panel"></div>
		<article>
			<input type="file" name="File"/>
			<button id="Filter" onclick="image.filter('invert');">反色滤镜</button>
			<button id="Filter" onclick="image.filter('grayscale');">黑白滤镜</button>
			<button id="Filter" onclick="image.filter('blur');">模糊滤镜</button>
			<button id="Filter" onclick="image.filter('sepia');">复古滤镜</button>
			<button onclick="image.mosaic('mosaic',10)">马赛克</button>
			<button onclick="image.eraser(0.3)">橡皮擦</button>
			<button onclick="ImageLayer.ruler(image,(res)=>console.log(res))">尺子</button>
			<button onclick="ImageLayer.straw(image,Images,(res)=>document.body.style.background=res)">吸管</button>
			<input type="range" name="" min="-255" max="255" value="0" oninput="image.filter('brightness',this.value)"> 亮度
			<input type="range" name="" min="0" step="0.01" max="1" value="1" oninput="image.filter('opacity',this.value)"> 透明度
			<!-- <input type="range" name="" min="-360" max="360" step="1" value="0" oninput="image.rotate(this.value)"> 旋转 -->
			<button onclick="image.transform()">图形变换</button>
			<button onclick="image.clip()">剪切</button>
			<button onclick="image.imageMatting()">抠图</button>
			<button onclick="image.pancil()">画笔</button>
			<input type="range" name="" min="1" max="100" value="3" step="1" oninput="ImageLayer.setBrushSize(this.value)"> 画笔大小
			<input type="color" name="" onchange="ImageLayer.setBrushColor(this.value)">画笔颜色
			<button onclick="image.resolve()">确认</button>
			<button onclick="image.saveClipArea()">确认剪切</button>
			<button onclick="image.saveImageMattingArea()">确认抠图</button>
			<button onclick="image.restore()">撤回</button>

			<button onclick="ImageLayer.download(image,Images)">下载</button>
			<!-- <button onclick="ImageLayer.download(image,Images)">下载</button> -->
		</article>
	</main>
	<script type="text/javascript" src="ImageLayer.js"></script>
	<script type="text/javascript" src="TextLayer.js"></script>
	<script type="text/javascript">
		var image = null;
		var Images = [];
		var top = 0;
		window.onload = function(){
			
			document.querySelector('input[name=File').onchange = function(){
				let reader = new FileReader();
				reader.readAsDataURL(this.files[0]);
				reader.onload = function(){
					image = new ImageLayer(document.getElementById('panel'));
					image.load(reader.result);
					Images.push(image);
					console.log(Images);
				}
			}
			
			image = new TextLayer(document.getElementById('panel'));

		}
	</script>
</body>
</html>